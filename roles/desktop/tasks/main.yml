- name: add launchpad ppa keys
  become_method: sudo
  become: yes
  apt_key:
    keyserver: keyserver.ubuntu.com
    state: present
    id: "{{ item }}"
  with_items:
    - "{{ repo_key_ubuntu_desktop }}"
- name: add repositories
  become_method: sudo
  become: yes
  apt_repository:
    mode: "{{ priv_sources }}"
    repo: "{{ item }}"
    state: present
    update_cache: false
  with_items:
    # REPO universe, multiverse
    - "{{ repo_multi1 }}"
    - "{{ repo_multi2 }}"
    - "{{ repo_multi3 }}"
    - "{{ repo_multi4 }}"
    # REPO canonical partners
    - "{{ repo_canonical }}"
    # REPO ubuntu-desktop | ubuntu-make
    - "{{ repo_ubuntu_desktop }}"
- name: update apt cache
  become_method: sudo
  become: yes
  apt:
    update_cache: yes
- name: check if ttf fonts are present
  stat:
    path: /usr/share/fonts/truetype/msttcorefonts/
  register: ttf_files
- name: accept ttf license
  become_method: sudo
  become: yes
  when: not "{{ ttf_files.stat.exists }} == 'false'"
  shell: 'echo ttf-mscorefonts-installer msttcorefonts/accepted-mscorefonts-eula select true | sudo debconf-set-selections'
- name: install packages
  become_method: sudo
  become: yes
  apt:
    name: "{{ item }}"
    state: present
  with_items:
    - libfreetype6  # fonts
    - libfreetype6-dev  # fonts
    - libfontconfig  # fonts
    - ttf-mscorefonts-installer  # fonts
    - ttf-ubuntu-font-family  # fonts
    - fonts-ubuntu-font-family-console  # fonts
    - caffeine
    - unity-tweak-tool
    - pinta
    - gimp
    - inkscape
    - ubuntu-restricted-extras  # codecs
    - libavcodec-extra  # codecs
    - ffmpeg  # codec
    - mplayer
    - smplayer
    - youtube-dl
    - lame  # codec
    - clementine
    - virtualbox
    - rdesktop
    - nautilus-dropbox
    - unrar
    - deluged
    - deluge-gtk
    - deluge-console
    - deluge-webui
    - skype
    - gtk2-engines-murrine:i386  # Skype visual
    - gtk2-engines-pixbuf:i386  # Skype visual
  ignore_errors: "{{ ansible_check_mode }}"
- name: apt upgrade
  become_method: sudo
  become: yes
  apt:
    upgrade: yes

