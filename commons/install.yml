- include: commons/apt_mscorefonts.yml
- include: commons/apt_oracle_java.yml
- name: add repository keys
  when: "{{ repos }}"
  become_method: sudo
  become: yes
  apt_key:
    keyserver: "{{ item.keyserver }}"
    state: present
    id: "{{ item.key }}"
  with_items:
    - "{{ repos | selectattr('key', 'defined') | selectattr('keyserver', 'defined') | list }}"
- name: add repositories
  when: "{{ repos }}"
  become_method: sudo
  become: yes
  apt_repository:
    mode: "{{ priv_sources }}"
    repo: "{{ item.repo }}"
    state: present
    update_cache: false
  with_items:
    - "{{ repos }}"
- name: update apt cache
  when: "{{ repos }}"
  become_method: sudo
  become: yes
  apt:
    update_cache: yes
- name: install packages
  when: "{{ packages }}"
  become_method: sudo
  become: yes
  apt:
    name: "{{ item }}"
    state: present
  with_items:
    - "{{ packages }}"

